<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>C.R.I.S â€” Presas Expostas</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body {
  background:#050505;
  color:#eaeaea;
  font-family: monospace;
  padding:20px;
}
.scanlines::before{
  content:"";
  position:fixed;
  inset:0;
  background:repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.03),
    rgba(255,255,255,0.03) 1px,
    transparent 1px,
    transparent 3px
  );
  pointer-events:none;
}
.panel {
  border:1px solid #500;
  padding:10px;
  margin:10px 0;
  background:#0b0b0b;
}
input,button{
  width:100%;
  margin:5px 0;
  padding:8px;
  background:#111;
  color:#fff;
  border:1px solid #500;
}
button{cursor:pointer}
.campanha{
  border:1px dashed #400;
  padding:8px;
  margin:5px 0;
}
.hidden{display:none}
h1{color:#b00}
</style>
</head>

<body class="scanlines">

<h1>ğŸ“¼ C.R.I.S</h1>
<p>Sistema de Campanhas â€” Presas Expostas</p>

<div class="panel" id="loginBox">
  <input id="email" placeholder="Email">
  <input id="senha" type="password" placeholder="Senha">
  <button onclick="login()">Entrar</button>
  <button onclick="registrar()">Criar Conta</button>
  <p id="erro"></p>
</div>

<div class="panel hidden" id="campanhasBox">
  <h2>ğŸ“ Campanhas</h2>
  <input id="novaCampanha" placeholder="Nome da campanha">
  <button onclick="criarCampanha()">Criar Campanha</button>
  <div id="listaCampanhas"></div>
  <button onclick="logout()">Sair</button>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyXXXX",
  authDomain: "rpg-campanha.firebaseapp.com",
  projectId: "rpg-campanha",
  storageBucket: "rpg-campanha.appspot.com",
  messagingSenderId: "1095737273808",
  appId: "1:1095737273808:web:XXXXXXXX"
};
  
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

auth.onAuthStateChanged(user=>{
  if(user){
    loginBox.classList.add("hidden");
    campanhasBox.classList.remove("hidden");
    carregarCampanhas();
  }
});

function login(){
  auth.signInWithEmailAndPassword(email.value,senha.value)
    .catch(e=>erro.innerText=e.message);
}
function registrar(){
  auth.createUserWithEmailAndPassword(email.value,senha.value)
    .catch(e=>erro.innerText=e.message);
}
function logout(){auth.signOut()}

function criarCampanha(){
  if(!novaCampanha.value) return;
  db.collection("campaigns").add({
    nome:novaCampanha.value,
    criadoEm:Date.now()
  }).then(doc=>{
    alert("Campanha criada!\nID: "+doc.id);
  });
  novaCampanha.value="";
}

function carregarCampanhas(){
  db.collection("campaigns").onSnapshot(snap=>{
    listaCampanhas.innerHTML="";
    snap.forEach(doc=>{
      const c=doc.data();
      listaCampanhas.innerHTML+=`
        <div class="campanha">
          <strong>${c.nome}</strong><br>
          <small>ID: ${doc.id}</small><br>
          <button onclick="entrar('${doc.id}','player')">Player</button>
          <button onclick="entrar('${doc.id}','master')">Mestre</button>
        </div>`;
    });
  });
}
function entrar(id,tipo){
  window.location.href=`${tipo}.html?id=${id}`;
}
</script>

</body>
</html>

